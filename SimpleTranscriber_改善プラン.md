# シンプル文字起こしツール性能改善プラン

## 現在の課題
- 大きなモデル (medium, large) 使用時のメモリ消費が多い
- 長時間の音声ファイル処理に時間がかかる

## 最もシンプルな改善アプローチ

### 1. ファイル分割処理の導入
- **概要**: 長い音声ファイルを自動的に短いセグメントに分割して処理
- **実装内容**:
  - FFmpegを使って入力ファイルを3〜5分単位のセグメントに自動分割
  - 各セグメントを順番に処理し、結果を自動的に結合
- **メリット**:
  - メモリ使用量の大幅削減（常に短いセグメントのみメモリに保持）
  - クラッシュリスクの低減
  - 既存コードベースへの変更は比較的小さい

### 2. プログレッシブ処理表示
- **概要**: セグメント処理ごとに結果を表示し、ユーザー体験を向上
- **実装内容**:
  - 各セグメントの処理が完了したら即座に結果を表示
  - 残りの処理時間の推定値を表示
  - セグメントごとの進捗状況をより詳細に表示
- **メリット**:
  - ユーザーはアプリケーションが「フリーズ」していないことを確認できる
  - 長い処理でも部分的な結果をすぐに確認できる

### 3. モデル選択のガイダンス強化（オプション）
- **概要**: ユーザーに適切なモデル選択を促すUI改善
- **実装内容**:
  - 各モデルサイズの具体的なメモリ要件と推奨ファイル長を表示
  - システムのRAM容量を検出し、警告表示を出す機能
  - 長いファイルが選択された場合、自動的に小さいモデルを推奨
- **メリット**:
  - 実装が非常にシンプル
  - ユーザー自身が適切な判断を下せるようになる

### 4. ユーザー設定の記憶（オプション）
- **概要**: ユーザー設定を記憶して次回起動時に再利用
- **実装内容**:
  - 最後に使用したモデルサイズ、言語設定を記憶
  - 前回の処理で問題が発生した場合は、より軽量なモデルを提案
  - 出力フォルダ設定などの環境設定を記憶
- **メリット**:
  - 実装が非常にシンプル（設定ファイルの読み書きのみ）
  - ユーザー体験の向上

## 実装の工数見積もり

以下は実装にかかる時間の見積もりです：

### 最小構成（ファイル分割+プログレッシブ表示のみ）
- **コード量**: 約85-110行の新規コードと修正
- **実装時間**: 約3時間10分

### フル実装（すべての機能）
- **コード量**: 約160-215行の新規コードと修正
- **実装時間**: 約5時間

## 実装方針

1. 新しいブランチを作成して実装を行う
2. まずファイル分割処理とプログレッシブ表示の基本機能を実装
3. 動作テスト後、必要に応じて追加機能を実装
4. ユーザーテストとフィードバック収集
5. 問題がなければメインブランチにマージ

## 将来の拡張可能性
- 分割サイズをユーザーが調整できるオプション
- バッチ処理の並列化によるさらなる高速化
- GPU対応版への拡張（オプション）

---
*作成日: 2025年4月20日*